@page
@model IndexModel
@{
    ViewData["Title"] = "Home Temperatures";
}
<div class="text-center">
    @if (Model.Readings != null && Model.Readings.Count > 0)
    {
        <p>Average temperature:</p>
        <h1 style="color: @(Model.AverageTemp()?.ColorCode)">@Html.Encode(Model.AverageTemp()?.Value)&deg;</h1>
        <br />
        <div class="image-container">
            <img src="~/plan.jpg" id="planImg" alt="floor plan image">
            @foreach (var reading in Model.Readings)
            {
                <div id="containerSensor@(reading.SensorId)">
                    <div class="overlay-text clickable" id="btn@(reading.SensorId)"
                        style="left: @(reading.PositionX)px; top: @(reading.PositionY)px; background-color: @reading.ColorCode" onclick="onHistoryModal('@reading.SensorId')">
                        @Html.Encode(@reading.Value)&deg;
                    </div>
                    <div id="history@(reading.SensorId)">
                       
                        <div class="modal" tabindex="-1" role="dialog" id="historyModal@(reading.SensorId)">
                            <div class="modal-dialog" role="document">
                                <div class="modal-content">
                                    <div class="modal-header">
                                        <h5 class="modal-title">@reading.SensorId history</h5>
                                        <button type="button" class="close" data-bs-dismiss="modal" aria-label="Close">
                                            <span aria-hidden="true">&times;</span>
                                        </button>
                                    </div>
                                    <div class="modal-body" id="body@(reading.SensorId)">
                                            <div id="chartHistory">
                                                <canvas id="chartImg@(reading.SensorId)" width="400" height="400">
                                                    </canvas>
                                            </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            }
        </div>
    }
    else
    {
        <p id="error">No readings recorded yet.</p>
        <img src="~/plan.jpg" id="planImg" alt="floor plan image">
    }
</div>
<script src="~/js/onHistoryModal.js" asp-append-version="true"></script>
<script src="~/js/chartHistory.js" asp-append-version="true"></script>